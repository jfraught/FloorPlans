import json
import xlsxwriter

#Workbook
workbook = xlsxwriter.Workbook('FloorPlan.xlsx')
worksheet = workbook.add_worksheet()
worksheet.set_column(0, 0, 27)
percent_fmt = workbook.add_format({'num_format': '0.00%'})


jsonFloorPlan = '{"floorPlans":[{"points":[{"y":-1.1198810450138799,"id":"0","z":0,"x":0.67406597032415627},{"y":-3.3231439588252876,"id":"1","z":0,"x":-3.2051836093067161},{"y":0.14306696868626423,"id":"2","z":0,"x":-5.1301285077428265},{"y":0.5433862083437121,"id":"3","z":0,"x":-4.3354123987165396},{"y":1.3104973738271082,"id":"4","z":0,"x":-4.7327704966118569},{"y":17.158535204198671,"id":"5","z":0,"x":26.250887545362307},{"y":2.2920537349894143,"id":"6","z":0,"x":-5.2033577926810644},{"y":5.4543433221627371,"id":"7","z":0,"x":-6.7343954503710934},{"y":6.5991944763564909,"id":"8","z":0,"x":-4.0262768228628847},{"y":1.7944931800343049,"id":"9","z":0,"x":-7.2330866279807964},{"y":2.1999295319137264,"id":"10","z":0,"x":-6.4237502550214387},{"y":0.20374536956781841,"id":"11","z":0,"x":-5.4780863322003128},{"y":-0.15943669651831954,"id":"12","z":0,"x":-6.1687027862075317},{"y":-0.17189695826699014,"id":"13","z":0,"x":-6.2924867411612455},{"y":-0.91117439406116096,"id":"14","z":0,"x":-7.8503599644496775},{"y":0.34513699436425149,"id":"15","z":0,"x":-8.3810002747771026},{"y":1.1269787534520406,"id":"16","z":0,"x":-6.8730335870263888},{"y":4.5702171856838039,"id":"17","z":0,"x":-7.4396123393313074},{"y":3.1110840987437189,"id":"18","z":0,"x":-10.543809813411237},{"y":0.90538654137656094,"id":"19","z":0,"x":-8.9728239265720156},{"y":2.5629018480364323,"id":"20","z":0,"x":-6.4748815863053206}],"walls":[{"roomID":1,"id":0,"otherRoomID":0,"line":{"id":"0","p1":{"y":-3.3231439588252876,"id":"1","z":0,"x":-3.2051836093067161},"p0":{"y":-1.1198810450138799,"id":"0","z":0,"x":0.67406597032415627}},"length":4.4612716537376462,"openings":[]},{"roomID":1,"id":1,"otherRoomID":0,"line":{"id":"1","p1":{"y":0.14306696868626423,"id":"2","z":0,"x":-5.1301285077428265},"p0":{"y":-3.3231439588252876,"id":"1","z":0,"x":-3.2051836093067161}},"length":3.9648494367397733,"openings":[]},{"roomID":1,"id":2,"otherRoomID":0,"line":{"id":"2","p1":{"y":0.5433862083437121,"id":"3","z":0,"x":-4.3354123987165396},"p0":{"y":0.14306696868626423,"id":"2","z":0,"x":-5.1301285077428265}},"length":0.88984784518804017,"openings":[]},{"roomID":1,"id":3,"otherRoomID":0,"line":{"id":"3","p1":{"y":1.3104973738271082,"id":"4","z":0,"x":-4.7327704966118569},"p0":{"y":0.5433862083437121,"id":"3","z":0,"x":-4.3354123987165396}},"length":0.86391724034902717,"openings":[]},{"roomID":1,"id":4,"otherRoomID":0,"line":{"id":"4","p1":{"y":17.158535204198671,"id":"5","z":0,"x":26.250887545362307},"p0":{"y":1.3104973738271082,"id":"4","z":0,"x":-4.7327704966118569}},"length":34.801542620046007,"openings":[]},{"roomID":1,"id":5,"otherRoomID":0,"line":{"id":"5","p1":{"y":2.2920537349894143,"id":"6","z":0,"x":-5.2033577926810644},"p0":{"y":17.158535204198671,"id":"5","z":0,"x":26.250887545362307}},"length":34.790542120814465,"openings":[]},{"roomID":1,"id":6,"otherRoomID":0,"line":{"id":"6","p1":{"y":5.4543433221627371,"id":"7","z":0,"x":-6.7343954503710934},"p0":{"y":2.2920537349894143,"id":"6","z":0,"x":-5.2033577926810644}},"length":3.5134245035876028,"openings":[]},{"roomID":1,"id":7,"otherRoomID":0,"line":{"id":"7","p1":{"y":6.5991944763564909,"id":"8","z":0,"x":-4.0262768228628847},"p0":{"y":5.4543433221627371,"id":"7","z":0,"x":-6.7343954503710934}},"length":2.9401684757706854,"openings":[]},{"roomID":1,"id":8,"otherRoomID":0,"line":{"id":"8","p1":{"y":-1.1198810450138799,"id":"0","z":0,"x":0.67406597032415627},"p0":{"y":6.5991944763564909,"id":"8","z":0,"x":-4.0262768228628847}},"length":9.0375521729107948,"openings":[]},{"roomID":2,"id":9,"otherRoomID":0,"line":{"id":"9","p1":{"y":2.1999295319137264,"id":"10","z":0,"x":-6.4237502550214387},"p0":{"y":1.7944931800343049,"id":"9","z":0,"x":-7.2330866279807964}},"length":0.90520936805818719,"openings":[]},{"roomID":2,"id":10,"otherRoomID":0,"line":{"id":"10","p1":{"y":0.20374536956781841,"id":"11","z":0,"x":-5.4780863322003128},"p0":{"y":2.1999295319137264,"id":"10","z":0,"x":-6.4237502550214387}},"length":2.2088529749456107,"openings":[]},{"roomID":2,"id":11,"otherRoomID":0,"line":{"id":"11","p1":{"y":-0.15943669651831954,"id":"12","z":0,"x":-6.1687027862075317},"p0":{"y":0.20374536956781841,"id":"11","z":0,"x":-5.4780863322003128}},"length":0.78028988182091719,"openings":[]},{"roomID":2,"id":12,"otherRoomID":0,"line":{"id":"12","p1":{"y":1.7944931800343049,"id":"9","z":0,"x":-7.2330866279807964},"p0":{"y":-0.15943669651831954,"id":"12","z":0,"x":-6.1687027862075317}},"length":2.2250291964630415,"openings":[]},{"roomID":3,"id":13,"otherRoomID":0,"line":{"id":"13","p1":{"y":-0.91117439406116096,"id":"14","z":0,"x":-7.8503599644496775},"p0":{"y":-0.17189695826699014,"id":"13","z":0,"x":-6.2924867411612455}},"length":1.724383978965675,"openings":[]},{"roomID":3,"id":14,"otherRoomID":0,"line":{"id":"14","p1":{"y":0.34513699436425149,"id":"15","z":0,"x":-8.3810002747771026},"p0":{"y":-0.91117439406116096,"id":"14","z":0,"x":-7.8503599644496775}},"length":1.3637805701914709,"openings":[]},{"roomID":3,"id":15,"otherRoomID":0,"line":{"id":"15","p1":{"y":1.1269787534520406,"id":"16","z":0,"x":-6.8730335870263888},"p0":{"y":0.34513699436425149,"id":"15","z":0,"x":-8.3810002747771026}},"length":1.698599442958624,"openings":[]},{"roomID":3,"id":16,"otherRoomID":0,"line":{"id":"16","p1":{"y":-0.17189695826699014,"id":"13","z":0,"x":-6.2924867411612455},"p0":{"y":1.1269787534520406,"id":"16","z":0,"x":-6.8730335870263888}},"length":1.4227131667126669,"openings":[]},{"roomID":4,"id":17,"otherRoomID":0,"line":{"id":"17","p1":{"y":3.1110840987437189,"id":"18","z":0,"x":-10.543809813411237},"p0":{"y":4.5702171856838039,"id":"17","z":0,"x":-7.4396123393313074}},"length":3.4300308050347761,"openings":[]},{"roomID":4,"id":18,"otherRoomID":0,"line":{"id":"18","p1":{"y":0.90538654137656094,"id":"19","z":0,"x":-8.9728239265720156},"p0":{"y":3.1110840987437189,"id":"18","z":0,"x":-10.543809813411237}},"length":2.7079694184431737,"openings":[]},{"roomID":4,"id":19,"otherRoomID":0,"line":{"id":"19","p1":{"y":2.5629018480364323,"id":"20","z":0,"x":-6.4748815863053206},"p0":{"y":0.90538654137656094,"id":"19","z":0,"x":-8.9728239265720156}},"length":2.9978447136415887,"openings":[]},{"roomID":4,"id":20,"otherRoomID":0,"line":{"id":"20","p1":{"y":4.5702171856838039,"id":"17","z":0,"x":-7.4396123393313074},"p0":{"y":2.5629018480364323,"id":"20","z":0,"x":-6.4748815863053206}},"length":2.2271103004989379,"openings":[]}],"type":"raw","rooms":[{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":0,"id":"","z":0,"x":0},"p0":{"y":0,"id":"","z":0,"x":0}},"number":1,"wallIDs":[0,1,2,3,4,5,6,7,8],"wallPoints":[{"y":0.084764271974563599,"id":"","z":0,"x":-0.059473417699337026},{"y":-0.76304656267166138,"id":"","z":0,"x":0.45678031444549561},{"y":-2.6061100959777832,"id":"","z":0,"x":-1.9427136182785034},{"y":-2.8715324401855469,"id":"","z":0,"x":-2.4100384712219238},{"y":-2.2344076633453369,"id":"","z":0,"x":-3.8098084926605225},{"y":-0.83931320905685425,"id":"","z":0,"x":-4.5845680236816406},{"y":0.40503701567649841,"id":"","z":0,"x":-4.6100640296936035},{"y":0.53051841259002686,"id":"","z":0,"x":-4.3609576225280762},{"y":0.61604708433151245,"id":"","z":0,"x":-4.3730502128601074},{"y":1.2313071489334106,"id":"","z":0,"x":-4.6917505264282227},{"y":1.2795449495315552,"id":"","z":0,"x":-4.7932839393615723},{"y":0.89129906892776489,"id":"","z":0,"x":-5.5523228645324707},{"y":1.9142434597015381,"id":"","z":0,"x":-6.0027222633361816},{"y":2.2706272602081299,"id":"","z":0,"x":-5.2486915588378906},{"y":2.3656973838806152,"id":"","z":0,"x":-5.2390127182006836},{"y":4.2345013618469238,"id":"","z":0,"x":-6.1438031196594238},{"y":5.474576473236084,"id":"","z":0,"x":-6.6865344047546387},{"y":6.2399106025695801,"id":"","z":0,"x":-4.8761544227600098}],"cornerPointIDs":[0,1,2,3,4,5,6,7,8],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}},{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":0,"id":"","z":0,"x":0},"p0":{"y":0,"id":"","z":0,"x":0}},"number":2,"wallIDs":[9,10,11,12],"wallPoints":[{"y":-0.079354062676429721,"id":"","z":0,"x":-6.2123270034790039},{"y":0.37113070487976074,"id":"","z":0,"x":-6.4577240943908691},{"y":1.887799859046936,"id":"","z":0,"x":-7.0468268394470215},{"y":2.1606771945953369,"id":"","z":0,"x":-6.5021061897277832},{"y":1.9642157554626465,"id":"","z":0,"x":-6.3120841979980469},{"y":1.7883942127227783,"id":"","z":0,"x":-6.2287912368774414},{"y":0.13898788392543793,"id":"","z":0,"x":-5.6012272834777832},{"y":-0.15666946768760681,"id":"","z":0,"x":-6.1634407043457031}],"cornerPointIDs":[9,10,11,12],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}},{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":0,"id":"","z":0,"x":0},"p0":{"y":0,"id":"","z":0,"x":0}},"number":3,"wallIDs":[13,14,15,16],"wallPoints":[{"y":0.32379323244094849,"id":"","z":0,"x":-6.5140409469604492},{"y":-0.14575627446174622,"id":"","z":0,"x":-6.3041706085205078},{"y":-0.47968539595603943,"id":"","z":0,"x":-6.9410867691040039},{"y":-0.57521295547485352,"id":"","z":0,"x":-7.1423912048339844},{"y":-0.37973731756210327,"id":"","z":0,"x":-8.0748281478881836},{"y":0.31952214241027832,"id":"","z":0,"x":-8.3701810836791992},{"y":0.43450376391410828,"id":"","z":0,"x":-8.2086353302001953},{"y":0.78005373477935791,"id":"","z":0,"x":-7.5421605110168457}],"cornerPointIDs":[13,14,15,16],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}},{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":0,"id":"","z":0,"x":0},"p0":{"y":0,"id":"","z":0,"x":0}},"number":4,"wallIDs":[17,18,19,20],"wallPoints":[{"y":2.3939528465270996,"id":"","z":0,"x":-6.3936834335327148},{"y":2.9699187278747559,"id":"","z":0,"x":-6.670496940612793},{"y":4.2875113487243652,"id":"","z":0,"x":-8.0410480499267578},{"y":3.5874626636505127,"id":"","z":0,"x":-9.5303497314453125},{"y":2.4925026893615723,"id":"","z":0,"x":-10.103231430053711},{"y":1.4358353614807129,"id":"","z":0,"x":-9.3506307601928711},{"y":1.3791353702545166,"id":"","z":0,"x":-8.2588653564453125},{"y":1.5215796232223511,"id":"","z":0,"x":-8.0441961288452148}],"cornerPointIDs":[17,18,19,20],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}}],"ceilingHeight":0},{"points":[{"y":-10.35221249292816,"id":"0","z":0,"x":-30.36904694258363},{"y":-17.233066422640263,"id":"1","z":0,"x":-33.672827263090866},{"y":-16.032750018628633,"id":"2","z":0,"x":-35.292904135616169},{"y":-11.136667421042659,"id":"3","z":0,"x":-35.066187877107751},{"y":-11.423874228808899,"id":"4","z":0,"x":-31.404148608736747},{"y":-177.98920584132262,"id":"5","z":0,"x":-38.908192762310193},{"y":-13.403686741891747,"id":"6","z":0,"x":-37.203030414635535},{"y":-13.341341354290883,"id":"7","z":0,"x":-39.435883526993251},{"y":269.57680756640298,"id":"8","z":0,"x":-39.435883526993251},{"y":-15.201762407682615,"id":"9","z":0,"x":-5.5691893506366998},{"y":-15.20187316954293,"id":"10","z":0,"x":-4.5585278821598969},{"y":-17.499098554203592,"id":"11","z":0,"x":-4.5583694252585225},{"y":-17.499035809579993,"id":"12","z":0,"x":-5.5691893506366998},{"y":-18.144529154927682,"id":"13","z":0,"x":-5.6228598408904258},{"y":-18.144529154927682,"id":"14","z":0,"x":-7.381463026665628},{"y":-16.732556663239308,"id":"15","z":0,"x":-7.3814613999747234},{"y":-16.732554585599694,"id":"16","z":0,"x":-5.6228889157145279},{"y":-12.542677295534078,"id":"17","z":0,"x":-5.8996701416365305},{"y":-12.542677295534078,"id":"18","z":0,"x":-9.2162073881292539},{"y":-15.143390842848397,"id":"19","z":0,"x":-9.2162152334457215},{"y":-15.144047225335619,"id":"20","z":0,"x":-5.8998111328552714}],"walls":[{"roomID":1,"id":0,"otherRoomID":0,"line":{"id":"0","p1":{"y":-17.233066422640263,"id":"1","z":0,"x":-33.672827263090866},"p0":{"y":-10.35221249292816,"id":"0","z":0,"x":-30.36904694258363}},"length":7.6328969080032376,"openings":[]},{"roomID":1,"id":1,"otherRoomID":0,"line":{"id":"1","p1":{"y":-16.032750018628633,"id":"2","z":0,"x":-35.292904135616169},"p0":{"y":-17.233066422640263,"id":"1","z":0,"x":-33.672827263090866}},"length":2.0162858286043615,"openings":[]},{"roomID":1,"id":2,"otherRoomID":0,"line":{"id":"2","p1":{"y":-11.136667421042659,"id":"3","z":0,"x":-35.066187877107751},"p0":{"y":-16.032750018628633,"id":"2","z":0,"x":-35.292904135616169}},"length":4.9013289079856976,"openings":[]},{"roomID":1,"id":3,"otherRoomID":0,"line":{"id":"3","p1":{"y":-11.423874228808899,"id":"4","z":0,"x":-31.404148608736747},"p0":{"y":-11.136667421042659,"id":"3","z":0,"x":-35.066187877107751}},"length":3.6732845456782286,"openings":[]},{"roomID":1,"id":4,"otherRoomID":0,"line":{"id":"4","p1":{"y":-177.98920584132262,"id":"5","z":0,"x":-38.908192762310193},"p0":{"y":-11.423874228808899,"id":"4","z":0,"x":-31.404148608736747}},"length":166.73428073988097,"openings":[]},{"roomID":1,"id":5,"otherRoomID":0,"line":{"id":"5","p1":{"y":-13.403686741891747,"id":"6","z":0,"x":-37.203030414635535},"p0":{"y":-177.98920584132262,"id":"5","z":0,"x":-38.908192762310193}},"length":164.59435189538266,"openings":[]},{"roomID":1,"id":6,"otherRoomID":0,"line":{"id":"6","p1":{"y":-13.341341354290883,"id":"7","z":0,"x":-39.435883526993251},"p0":{"y":-13.403686741891747,"id":"6","z":0,"x":-37.203030414635535}},"length":2.2337233420279787,"openings":[]},{"roomID":1,"id":7,"otherRoomID":0,"line":{"id":"7","p1":{"y":269.57680756640298,"id":"8","z":0,"x":-39.435883526993251},"p0":{"y":-13.341341354290883,"id":"7","z":0,"x":-39.435883526993251}},"length":282.91814892069385,"openings":[]},{"roomID":1,"id":8,"otherRoomID":0,"line":{"id":"8","p1":{"y":-10.35221249292816,"id":"0","z":0,"x":-30.36904694258363},"p0":{"y":269.57680756640298,"id":"8","z":0,"x":-39.435883526993251}},"length":280.07581794404496,"openings":[]},{"roomID":2,"id":9,"otherRoomID":0,"line":{"id":"9","p1":{"y":-15.20187316954293,"id":"10","z":0,"x":-4.5585278821598969},"p0":{"y":-15.201762407682615,"id":"9","z":0,"x":-5.5691893506366998}},"length":1.0106614745461893,"openings":[]},{"roomID":2,"id":10,"otherRoomID":0,"line":{"id":"10","p1":{"y":-17.499098554203592,"id":"11","z":0,"x":-4.5583694252585225},"p0":{"y":-15.20187316954293,"id":"10","z":0,"x":-4.5585278821598969}},"length":2.2972253901256434,"openings":[]},{"roomID":2,"id":11,"otherRoomID":0,"line":{"id":"11","p1":{"y":-17.499035809579993,"id":"12","z":0,"x":-5.5691893506366998},"p0":{"y":-17.499098554203592,"id":"11","z":0,"x":-4.5583694252585225}},"length":1.0108199273255507,"openings":[]},{"roomID":2,"id":12,"otherRoomID":0,"line":{"id":"12","p1":{"y":-15.201762407682615,"id":"9","z":0,"x":-5.5691893506366998},"p0":{"y":-17.499035809579993,"id":"12","z":0,"x":-5.5691893506366998}},"length":2.2972734018973782,"openings":[]},{"roomID":3,"id":13,"otherRoomID":0,"line":{"id":"13","p1":{"y":-18.144529154927682,"id":"14","z":0,"x":-7.381463026665628},"p0":{"y":-18.144529154927682,"id":"13","z":0,"x":-5.6228598408904258}},"length":1.7586031857752022,"openings":[]},{"roomID":3,"id":14,"otherRoomID":0,"line":{"id":"14","p1":{"y":-16.732556663239308,"id":"15","z":0,"x":-7.3814613999747234},"p0":{"y":-18.144529154927682,"id":"14","z":0,"x":-7.381463026665628}},"length":1.411972491689311,"openings":[]},{"roomID":3,"id":15,"otherRoomID":0,"line":{"id":"15","p1":{"y":-16.732554585599694,"id":"16","z":0,"x":-5.6228889157145279},"p0":{"y":-16.732556663239308,"id":"15","z":0,"x":-7.3814613999747234}},"length":1.7585724842614228,"openings":[]},{"roomID":3,"id":16,"otherRoomID":0,"line":{"id":"16","p1":{"y":-18.144529154927682,"id":"13","z":0,"x":-5.6228598408904258},"p0":{"y":-16.732554585599694,"id":"16","z":0,"x":-5.6228889157145279}},"length":1.4119745696273367,"openings":[]},{"roomID":4,"id":17,"otherRoomID":0,"line":{"id":"17","p1":{"y":-12.542677295534078,"id":"18","z":0,"x":-9.2162073881292539},"p0":{"y":-12.542677295534078,"id":"17","z":0,"x":-5.8996701416365305}},"length":3.3165372464927234,"openings":[]},{"roomID":4,"id":18,"otherRoomID":0,"line":{"id":"18","p1":{"y":-15.143390842848397,"id":"19","z":0,"x":-9.2162152334457215},"p0":{"y":-12.542677295534078,"id":"18","z":0,"x":-9.2162073881292539}},"length":2.6007135473261522,"openings":[]},{"roomID":4,"id":19,"otherRoomID":0,"line":{"id":"19","p1":{"y":-15.144047225335619,"id":"20","z":0,"x":-5.8998111328552714},"p0":{"y":-15.143390842848397,"id":"19","z":0,"x":-9.2162152334457215}},"length":3.3164041655460395,"openings":[]},{"roomID":4,"id":20,"otherRoomID":0,"line":{"id":"20","p1":{"y":-12.542677295534078,"id":"17","z":0,"x":-5.8996701416365305},"p0":{"y":-15.144047225335619,"id":"20","z":0,"x":-5.8998111328552714}},"length":2.6013699336223204,"openings":[]}],"type":"orthorectified","rooms":[{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":-0.76323062181472778,"id":"","z":0,"x":0.45909422636032104},"p0":{"y":0.079621799290180206,"id":"","z":0,"x":-0.03386031836271286}},"number":1,"wallIDs":[0,1,2,3,4,5,6,7,8],"wallPoints":[{"y":-11.717192888088334,"id":"","z":0,"x":-27.218817025588031},{"y":-12.709295974431413,"id":"","z":0,"x":-27.186683034775445},{"y":-16.223951768965279,"id":"","z":0,"x":-30.082291393965537},{"y":-17.273101664968479,"id":"","z":0,"x":-30.586031309837079},{"y":-12.081803307722538,"id":"","z":0,"x":-37.519510725500751},{"y":-10.552053644968964,"id":"","z":0,"x":-39.584226363058939},{"y":1.570657508093376,"id":"","z":0,"x":-31.371748494899226},{"y":5.1168874998394713,"id":"","z":0,"x":-31.207538030816089},{"y":-9.7469047180733099,"id":"","z":0,"x":-49.680381606779797},{"y":-9.2562656130418688,"id":"","z":0,"x":-55.936290661296241},{"y":-41.8031840762374,"id":"","z":0,"x":-29.666768333718352},{"y":-52.818176310611506,"id":"","z":0,"x":-30.163011983449145},{"y":52.17832172250651,"id":"","z":0,"x":-33.417559829498536},{"y":71.697493412722892,"id":"","z":0,"x":-33.215334525558852},{"y":-10.578079563644323,"id":"","z":0,"x":-135.29400537387343},{"y":-9.6163264198910383,"id":"","z":0,"x":-169.73847004056623},{"y":180.99448278690048,"id":"","z":0,"x":-36.32986501109216},{"y":241.70921667534148,"id":"","z":0,"x":-36.329865011092132}],"cornerPointIDs":[0,1,2,3,4,5,6,7,8],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}},{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":0.36893659830093384,"id":"","z":0,"x":-6.5241632461547852},"p0":{"y":-0.091918855905532865,"id":"","z":0,"x":-6.2938117980957031}},"number":2,"wallIDs":[9,10,11,12],"wallPoints":[{"y":-1.8808736521668497,"id":"","z":0,"x":-9.8836103653925083},{"y":-1.3678417823662223,"id":"","z":0,"x":-9.8836103653925065},{"y":0.25255469867149194,"id":"","z":0,"x":-9.5784997632692974},{"y":0.25248792346786231,"id":"","z":0,"x":-8.9692004505984109},{"y":-0.05154075975581307,"id":"","z":0,"x":-8.8729279264998731},{"y":-0.24611089346458703,"id":"","z":0,"x":-8.8729145055353023},{"y":-2.044729216781608,"id":"","z":0,"x":-9.1755460651805887},{"y":-2.044689783753709,"id":"","z":0,"x":-9.8108146832115182}],"cornerPointIDs":[9,10,11,12],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}},{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":-0.19742800295352936,"id":"","z":0,"x":-6.3087525367736816},"p0":{"y":0.29359352588653564,"id":"","z":0,"x":-6.5343189239501953}},"number":3,"wallIDs":[13,14,15,16],"wallPoints":[{"y":-1.8580911310450605,"id":"","z":0,"x":-9.5795880921859862},{"y":-2.3724257500461636,"id":"","z":0,"x":-9.5795775012101227},{"y":-2.4195814129606763,"id":"","z":0,"x":-10.340885007119056},{"y":-2.4195814129606696,"id":"","z":0,"x":-10.56371300139776},{"y":-1.8491861176999995,"id":"","z":0,"x":-11.338179058839291},{"y":-1.09008420023445,"id":"","z":0,"x":-11.338178184300872},{"y":-1.0076086566491478,"id":"","z":0,"x":-11.114193627343068},{"y":-1.0076077696821488,"id":"","z":0,"x":-10.363439861563208}],"cornerPointIDs":[13,14,15,16],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}},{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":2.9076685905456543,"id":"","z":0,"x":-6.715662956237793},"p0":{"y":2.3254983425140381,"id":"","z":0,"x":-6.4384546279907227}},"number":4,"wallIDs":[17,18,19,20],"wallPoints":[{"y":-0.148419009824033,"id":"","z":0,"x":-9.5939617216947291},{"y":0.49063406130740117,"id":"","z":0,"x":-9.5939270857629761},{"y":2.2882024893680524,"id":"","z":0,"x":-10.352766003875498},{"y":2.2882024893680528,"id":"","z":0,"x":-11.998445340315277},{"y":1.5303006333569651,"id":"","z":0,"x":-12.91036919242956},{"y":0.23297218999410241,"id":"","z":0,"x":-12.910373105952532},{"y":-0.31273291197254749,"id":"","z":0,"x":-11.789446608517606},{"y":-0.31278390380304044,"id":"","z":0,"x":-11.531807931240619}],"cornerPointIDs":[17,18,19,20],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}}],"ceilingHeight":0},{"points":[{"y":-10.35221249292816,"id":"0","z":0,"x":-30.36904694258363},{"y":-17.233066422640263,"id":"1","z":0,"x":-33.672827263090866},{"y":-16.032750018628633,"id":"2","z":0,"x":-35.292904135616169},{"y":-11.136667421042659,"id":"3","z":0,"x":-35.066187877107751},{"y":-11.423874228808899,"id":"4","z":0,"x":-31.404148608736747},{"y":-177.98920584132262,"id":"5","z":0,"x":-38.908192762310193},{"y":-13.403686741891747,"id":"6","z":0,"x":-37.203030414635535},{"y":-13.341341354290883,"id":"7","z":0,"x":-39.435883526993251},{"y":269.57680756640298,"id":"8","z":0,"x":-39.435883526993251},{"y":-15.201762407682615,"id":"9","z":0,"x":-5.5691893506366998},{"y":-15.20187316954293,"id":"10","z":0,"x":-4.5585278821598969},{"y":-17.499098554203592,"id":"11","z":0,"x":-4.5583694252585225},{"y":-17.499035809579993,"id":"12","z":0,"x":-5.5691893506366998},{"y":-18.144529154927682,"id":"13","z":0,"x":-5.6228598408904258},{"y":-18.144529154927682,"id":"14","z":0,"x":-7.381463026665628},{"y":-16.732556663239308,"id":"15","z":0,"x":-7.3814613999747234},{"y":-16.732554585599694,"id":"16","z":0,"x":-5.6228889157145279},{"y":-12.542677295534078,"id":"17","z":0,"x":-5.8996701416365305},{"y":-12.542677295534078,"id":"18","z":0,"x":-9.2162073881292539},{"y":-15.143390842848397,"id":"19","z":0,"x":-9.2162152334457215},{"y":-15.144047225335619,"id":"20","z":0,"x":-5.8998111328552714}],"walls":[{"roomID":1,"id":0,"otherRoomID":0,"line":{"id":"0","p1":{"y":-17.233066422640263,"id":"1","z":0,"x":-33.672827263090866},"p0":{"y":-10.35221249292816,"id":"0","z":0,"x":-30.36904694258363}},"length":9.1568969080032847,"openings":[]},{"roomID":1,"id":1,"otherRoomID":0,"line":{"id":"1","p1":{"y":-16.032750018628633,"id":"2","z":0,"x":-35.292904135616169},"p0":{"y":-17.233066422640263,"id":"1","z":0,"x":-33.672827263090866}},"length":3.1465858286043753,"openings":[]},{"roomID":1,"id":2,"otherRoomID":0,"line":{"id":"2","p1":{"y":-11.136667421042659,"id":"3","z":0,"x":-35.066187877107751},"p0":{"y":-16.032750018628633,"id":"2","z":0,"x":-35.292904135616169}},"length":3.9869289079857175,"openings":[]},{"roomID":1,"id":3,"otherRoomID":0,"line":{"id":"3","p1":{"y":-11.423874228808899,"id":"4","z":0,"x":-31.404148608736747},"p0":{"y":-11.136667421042659,"id":"3","z":0,"x":-35.066187877107751}},"length":2.073084545678209,"openings":[]},{"roomID":1,"id":4,"otherRoomID":0,"line":{"id":"4","p1":{"y":-177.98920584132262,"id":"5","z":0,"x":-38.908192762310193},"p0":{"y":-11.423874228808899,"id":"4","z":0,"x":-31.404148608736747}},"length":166.73428073988097,"openings":[]},{"roomID":1,"id":5,"otherRoomID":0,"line":{"id":"5","p1":{"y":-13.403686741891747,"id":"6","z":0,"x":-37.203030414635535},"p0":{"y":-177.98920584132262,"id":"5","z":0,"x":-38.908192762310193}},"length":164.59435189538266,"openings":[]},{"roomID":1,"id":6,"otherRoomID":0,"line":{"id":"6","p1":{"y":-13.341341354290883,"id":"7","z":0,"x":-39.435883526993251},"p0":{"y":-13.403686741891747,"id":"6","z":0,"x":-37.203030414635535}},"length":2.2337233420279787,"openings":[]},{"roomID":1,"id":7,"otherRoomID":0,"line":{"id":"7","p1":{"y":269.57680756640298,"id":"8","z":0,"x":-39.435883526993251},"p0":{"y":-13.341341354290883,"id":"7","z":0,"x":-39.435883526993251}},"length":282.91814892069385,"openings":[]},{"roomID":1,"id":8,"otherRoomID":0,"line":{"id":"8","p1":{"y":-10.35221249292816,"id":"0","z":0,"x":-30.36904694258363},"p0":{"y":269.57680756640298,"id":"8","z":0,"x":-39.435883526993251}},"length":280.07581794404496,"openings":[]},{"roomID":2,"id":9,"otherRoomID":0,"line":{"id":"9","p1":{"y":-15.20187316954293,"id":"10","z":0,"x":-4.5585278821598969},"p0":{"y":-15.201762407682615,"id":"9","z":0,"x":-5.5691893506366998}},"length":1.0106614745461893,"openings":[]},{"roomID":2,"id":10,"otherRoomID":0,"line":{"id":"10","p1":{"y":-17.499098554203592,"id":"11","z":0,"x":-4.5583694252585225},"p0":{"y":-15.20187316954293,"id":"10","z":0,"x":-4.5585278821598969}},"length":2.2972253901256434,"openings":[]},{"roomID":2,"id":11,"otherRoomID":0,"line":{"id":"11","p1":{"y":-17.499035809579993,"id":"12","z":0,"x":-5.5691893506366998},"p0":{"y":-17.499098554203592,"id":"11","z":0,"x":-4.5583694252585225}},"length":1.0108199273255507,"openings":[]},{"roomID":2,"id":12,"otherRoomID":0,"line":{"id":"12","p1":{"y":-15.201762407682615,"id":"9","z":0,"x":-5.5691893506366998},"p0":{"y":-17.499035809579993,"id":"12","z":0,"x":-5.5691893506366998}},"length":2.2972734018973782,"openings":[]},{"roomID":3,"id":13,"otherRoomID":0,"line":{"id":"13","p1":{"y":-18.144529154927682,"id":"14","z":0,"x":-7.381463026665628},"p0":{"y":-18.144529154927682,"id":"13","z":0,"x":-5.6228598408904258}},"length":1.7586031857752022,"openings":[]},{"roomID":3,"id":14,"otherRoomID":0,"line":{"id":"14","p1":{"y":-16.732556663239308,"id":"15","z":0,"x":-7.3814613999747234},"p0":{"y":-18.144529154927682,"id":"14","z":0,"x":-7.381463026665628}},"length":1.411972491689311,"openings":[]},{"roomID":3,"id":15,"otherRoomID":0,"line":{"id":"15","p1":{"y":-16.732554585599694,"id":"16","z":0,"x":-5.6228889157145279},"p0":{"y":-16.732556663239308,"id":"15","z":0,"x":-7.3814613999747234}},"length":1.7585724842614228,"openings":[]},{"roomID":3,"id":16,"otherRoomID":0,"line":{"id":"16","p1":{"y":-18.144529154927682,"id":"13","z":0,"x":-5.6228598408904258},"p0":{"y":-16.732554585599694,"id":"16","z":0,"x":-5.6228889157145279}},"length":1.4119745696273367,"openings":[]},{"roomID":4,"id":17,"otherRoomID":0,"line":{"id":"17","p1":{"y":-12.542677295534078,"id":"18","z":0,"x":-9.2162073881292539},"p0":{"y":-12.542677295534078,"id":"17","z":0,"x":-5.8996701416365305}},"length":3.3165372464927234,"openings":[]},{"roomID":4,"id":18,"otherRoomID":0,"line":{"id":"18","p1":{"y":-15.143390842848397,"id":"19","z":0,"x":-9.2162152334457215},"p0":{"y":-12.542677295534078,"id":"18","z":0,"x":-9.2162073881292539}},"length":2.6007135473261522,"openings":[]},{"roomID":4,"id":19,"otherRoomID":0,"line":{"id":"19","p1":{"y":-15.144047225335619,"id":"20","z":0,"x":-5.8998111328552714},"p0":{"y":-15.143390842848397,"id":"19","z":0,"x":-9.2162152334457215}},"length":3.3164041655460395,"openings":[]},{"roomID":4,"id":20,"otherRoomID":0,"line":{"id":"20","p1":{"y":-12.542677295534078,"id":"17","z":0,"x":-5.8996701416365305},"p0":{"y":-15.144047225335619,"id":"20","z":0,"x":-5.8998111328552714}},"length":2.6013699336223204,"openings":[]}],"type":"correctedMeasurment","rooms":[{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":-0.76323062181472778,"id":"","z":0,"x":0.45909422636032104},"p0":{"y":0.079621799290180206,"id":"","z":0,"x":-0.03386031836271286}},"number":1,"wallIDs":[0,1,2,3,4,5,6,7,8],"wallPoints":[{"y":-11.717192888088334,"id":"","z":0,"x":-27.218817025588031},{"y":-12.709295974431413,"id":"","z":0,"x":-27.186683034775445},{"y":-16.223951768965279,"id":"","z":0,"x":-30.082291393965537},{"y":-17.273101664968479,"id":"","z":0,"x":-30.586031309837079},{"y":-12.081803307722538,"id":"","z":0,"x":-37.519510725500751},{"y":-10.552053644968964,"id":"","z":0,"x":-39.584226363058939},{"y":1.570657508093376,"id":"","z":0,"x":-31.371748494899226},{"y":5.1168874998394713,"id":"","z":0,"x":-31.207538030816089},{"y":-9.7469047180733099,"id":"","z":0,"x":-49.680381606779797},{"y":-9.2562656130418688,"id":"","z":0,"x":-55.936290661296241},{"y":-41.8031840762374,"id":"","z":0,"x":-29.666768333718352},{"y":-52.818176310611506,"id":"","z":0,"x":-30.163011983449145},{"y":52.17832172250651,"id":"","z":0,"x":-33.417559829498536},{"y":71.697493412722892,"id":"","z":0,"x":-33.215334525558852},{"y":-10.578079563644323,"id":"","z":0,"x":-135.29400537387343},{"y":-9.6163264198910383,"id":"","z":0,"x":-169.73847004056623},{"y":180.99448278690048,"id":"","z":0,"x":-36.32986501109216},{"y":241.70921667534148,"id":"","z":0,"x":-36.329865011092132}],"cornerPointIDs":[0,1,2,3,4,5,6,7,8],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}},{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":0.36893659830093384,"id":"","z":0,"x":-6.5241632461547852},"p0":{"y":-0.091918855905532865,"id":"","z":0,"x":-6.2938117980957031}},"number":2,"wallIDs":[9,10,11,12],"wallPoints":[{"y":-1.8808736521668497,"id":"","z":0,"x":-9.8836103653925083},{"y":-1.3678417823662223,"id":"","z":0,"x":-9.8836103653925065},{"y":0.25255469867149194,"id":"","z":0,"x":-9.5784997632692974},{"y":0.25248792346786231,"id":"","z":0,"x":-8.9692004505984109},{"y":-0.05154075975581307,"id":"","z":0,"x":-8.8729279264998731},{"y":-0.24611089346458703,"id":"","z":0,"x":-8.8729145055353023},{"y":-2.044729216781608,"id":"","z":0,"x":-9.1755460651805887},{"y":-2.044689783753709,"id":"","z":0,"x":-9.8108146832115182}],"cornerPointIDs":[9,10,11,12],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}},{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":-0.19742800295352936,"id":"","z":0,"x":-6.3087525367736816},"p0":{"y":0.29359352588653564,"id":"","z":0,"x":-6.5343189239501953}},"number":3,"wallIDs":[13,14,15,16],"wallPoints":[{"y":-1.8580911310450605,"id":"","z":0,"x":-9.5795880921859862},{"y":-2.3724257500461636,"id":"","z":0,"x":-9.5795775012101227},{"y":-2.4195814129606763,"id":"","z":0,"x":-10.340885007119056},{"y":-2.4195814129606696,"id":"","z":0,"x":-10.56371300139776},{"y":-1.8491861176999995,"id":"","z":0,"x":-11.338179058839291},{"y":-1.09008420023445,"id":"","z":0,"x":-11.338178184300872},{"y":-1.0076086566491478,"id":"","z":0,"x":-11.114193627343068},{"y":-1.0076077696821488,"id":"","z":0,"x":-10.363439861563208}],"cornerPointIDs":[13,14,15,16],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}},{"initialCeilingPoint":{"y":0,"id":"","z":0,"x":0},"calibrationLine":{"id":"","p1":{"y":2.9076685905456543,"id":"","z":0,"x":-6.715662956237793},"p0":{"y":2.3254983425140381,"id":"","z":0,"x":-6.4384546279907227}},"number":4,"wallIDs":[17,18,19,20],"wallPoints":[{"y":-0.148419009824033,"id":"","z":0,"x":-9.5939617216947291},{"y":0.49063406130740117,"id":"","z":0,"x":-9.5939270857629761},{"y":2.2882024893680524,"id":"","z":0,"x":-10.352766003875498},{"y":2.2882024893680528,"id":"","z":0,"x":-11.998445340315277},{"y":1.5303006333569651,"id":"","z":0,"x":-12.91036919242956},{"y":0.23297218999410241,"id":"","z":0,"x":-12.910373105952532},{"y":-0.31273291197254749,"id":"","z":0,"x":-11.789446608517606},{"y":-0.31278390380304044,"id":"","z":0,"x":-11.531807931240619}],"cornerPointIDs":[17,18,19,20],"ceilingPoint":{"y":0,"id":"","z":0,"x":0}}],"ceilingHeight":0}]}'

#Get JSON Function
#Loop through folder of JSON files and add a worksheet to the workbook for each. 
def getJSON(filePathAndName):
    with open(filePathAndName, 'r') as fp:
        return json.load(fp)



#Make Excel Function

#def makeWorkbook():
#def makeWorksheet();
#def metersToFeetandInches(meters):

def formatExcel():
    roomsCount()
    wallCount()
    groupWalls()
    worksheet.write('A3', 'Ortho Walls in Feet')
    displayWalls(0, tupleWallList, 2)
    worksheet.write('A4', 'Corrected Walls in Feet')
    displayWalls(1, tupleWallList, 3)
    absoluteValueDifference()
    percentageDifference()
    averageDifference()
    contributionToWeight()
    weightedPercentage()
    #Weighted Difference Avergage

def makeFloorPlanList(jsonPlan):
    pyFloorPlan = json.loads(jsonPlan)
    floorPlanList = pyFloorPlan["floorPlans"]
    return floorPlanList

#Wall Functions
def getWalls(type): 
    wallsList = []
    for floor in floorPlanList:
        if floor["type"] == type:
            walls = floor["walls"]
            for wall in walls:
                lengthInMeters = wall["length"]
                lengthInFeet = metersTofFeet(lengthInMeters)
                wallsList.append(lengthInFeet)
    return wallsList

def fixCorrectedWallsList(correctedWallsList):
    halfListCount = len(correctedWallsList) / 2
    listCount = len(correctedWallsList)
    while listCount > halfListCount:
        del correctedWallsList[listCount - 1]
        listCount -= 1
    return correctedWallsList

def wallCount():
    worksheet.write('A2', 'Wall Count')
    worksheet.write('B2', len(orthoWallsList))

def groupWalls():
    index = 0
    for wall in orthoWallsList:
        walls = (wall, correctWallsList[index])
        index += 1
        tupleWallList.append(walls)
    tupleWallList.sort(key = sortOrtho)

def sortOrtho(val):
    return val[0]

def displayWalls(wallType, walls, row):  
    col = 1
    for wall in walls:
        worksheet.write(row, col, wall[wallType])
        col += 1
        
def absoluteValueDifference():
    col = 1
    worksheet.write(4, 0, 'Absolute Value Difference in Inches')
    for x in range(len(tupleWallList)):
        tupleAtIndex = tupleWallList[x]
        orthoWall = tupleAtIndex[0]
        correctWall = tupleAtIndex[1]
        differenceInFeet = abs(orthoWall - correctWall)
        differenceInInches = feetToInches(differenceInFeet)
        differenceList.append(differenceInFeet)
        worksheet.write(4, col, differenceInInches)
        col += 1
        
def percentageDifference():
    worksheet.write(5, 0, 'Percentage Difference')
    worksheet.set_row(5, None, percent_fmt)
    col = 1
    for x in range(len(tupleWallList)):
        tupleAtIndex = tupleWallList[x]
        orthoWall = tupleAtIndex[0]
        percent = differenceList[x] / orthoWall
        percentageList.append(percent)
        worksheet.write(5, col, percent)
        col += 1

def averageDifference():
    wallsByHand = 0
    differenceSum = 0
    for value in differenceList:
        if value != 0:
            wallsByHand += 1
            differenceSum += value
    difference = differenceSum / wallsByHand
    differenceInInches = feetToInches(difference)
    worksheet.write('A7', 'Average difference in Inches')
    worksheet.write(6, 1, differenceInInches)

def contributionToWeight():
    orthoSum = 0
    contribution = 0
    col = 1
    worksheet.write('A8', 'Contribution to weight')
    for x in range(len(tupleWallList)):
        tupleAtIndex = tupleWallList[x]
        orthoWall = tupleAtIndex[0]
        if differenceList[x] != 0:
            orthoSum += orthoWall
    for x in range(len(tupleWallList)):
        tupleAtIndex = tupleWallList[x]
        orthoWall = tupleAtIndex[0]
        difference = differenceList[x]
        if difference != 0.0:
            contribution = orthoWall / orthoSum
            worksheet.write(7, col, contribution)
        else: 
            contribution = 0
        contributionList.append(contribution)
        col += 1

def weightedPercentage():
    worksheet.write('A9', 'Weighted Percentage')
    worksheet.write('A10', 'Weighted Difference Average')
    weightedPercentage = 0
    weightedPercentageAverage = 0
    col = 1
    listCount = 0
    worksheet.set_row(8, None, percent_fmt)
    worksheet.set_row(9, None, percent_fmt)
    for x in range(len(percentageList)):
        if percentageList[x] != 0:
            weightedPercentage = contributionList[x] * percentageList[x] 
            listCount += 1
        else:
            weightedPercentage = 0
        worksheet.write(8, col, weightedPercentage)
        col += 1
        weightedPercentageAverage += weightedPercentage
    worksheet.write('B10', weightedPercentageAverage)

def metersTofFeet(meters):
    feet = meters / 0.3048
    return feet

def feetToInches(feet):
    inches = feet * 12
    return inches

#Room Functions

def roomsCount():
    roomList = []
    worksheet.write('A1', 'Room Count')
    roomNumber = 1
    for floor in floorPlanList:
        if floor["type"] == "orthorectified":
            rooms = floor["rooms"]
            for room in rooms:
                roomNumber += 1
                roomList.append(room)
    worksheet.write(0, 1, len(roomList))

#Variables

floorPlanList = makeFloorPlanList(jsonFloorPlan)
orthoWallsList = getWalls("orthorectified")
correctWallsList = getWalls("correctedMeasurment")  
if len(orthoWallsList) != len(correctWallsList):
    correctWallsList = fixCorrectedWallsList(correctWallsList)
tupleWallList = []
differenceList = []
percentageList = []
contributionList = []
weightedPercentagList = []

formatExcel()
groupWalls()
workbook.close()
